---
import { Image } from "astro:assets";
import hero1 from "/src/assets/images/hero.svg";
import hero2 from "/src/assets/images/hero-2.svg";
import hero3 from "/src/assets/images/hero-3.svg";

const slides = [
  { src: hero1, alt: "Banner utama SMK Nusantara" },
  { src: hero2, alt: "SPMB SMK Nusantara" },
  { src: hero3, alt: "Cara Mendaftar SMK Nusantara" }
];
---

<section
  id="home"
  class="pt-16 relative sm:min-h-screen bg-gradient-to-br from-blue-600 to-indigo-700 text-white overflow-hidden"
>
  <!-- ================= MOBILE HERO (1 IMAGE ONLY) ================= -->
  <Image
    src={hero1}
    alt="Banner utama SMK Nusantara"
    loading="eager"
    fetchpriority="high"
    class="sm:hidden w-full h-auto object-contain"
  />

  <!-- ================= DESKTOP SLIDER ================= -->
  <div class="hidden sm:block relative w-full h-screen overflow-hidden">
    {slides.map((slide, i) => (
      <Image
        src={slide.src}
        alt={slide.alt}
        aria-hidden="true"
        loading={i === 0 ? "eager" : "lazy"}
        class="absolute top-0 left-0 w-full h-full object-cover transition-opacity duration-700"
        style={`opacity: ${i === 0 ? 1 : 0}`}
        data-slide-index={i}
      />
    ))}

    <!-- BULLETS -->
    <div class="absolute bottom-8 left-1/2 -translate-x-1/2 flex gap-3 z-20">
      {slides.map((_, i) => (
        <button class={`dot w-2.5 h-2.5 rounded-full ${i===0 ? "bg-white" : "bg-white/40"}`} data-dot-index={i}></button>
      ))}
    </div>
  </div>
</section>

<script>
  // ================= DESKTOP SLIDER JS =================
  const slideEls = document.querySelectorAll("[data-slide-index]");
  const dotEls = document.querySelectorAll("[data-dot-index]");
  let currentIndex = 0;

  function showSlide(index) {
    slideEls.forEach((el, i) => el.style.opacity = i === index ? "1" : "0");
    dotEls.forEach((dot, i) => {
      dot.classList.toggle("bg-white", i === index);
      dot.classList.toggle("bg-white/40", i !== index);
    });
  }

  dotEls.forEach((dot, i) => {
    dot.addEventListener("click", () => {
      currentIndex = i;
      showSlide(currentIndex);
    });
  });

  setInterval(() => {
    currentIndex = (currentIndex + 1) % slideEls.length;
    showSlide(currentIndex);
  }, 6000);
</script>
